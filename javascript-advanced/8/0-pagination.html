<title>Pagination</title>

<script type="module" id="Pagination basics">

    // import axios from "https://cdn.jsdelivr.net/npm/axios@1.7.2/+esm";
    
    // const getPosts = (_page) => axios.get("https://jsonplaceholder.typicode.com/posts", {
    //         params: {
    //             _page,
    //             _limit: 5,
    //         }
    //     })
    //     .then(res => res.data);

    // getPosts(1).then(console.log);
    // getPosts(2).then(console.log);
    // getPosts(3).then(console.log);

</script>

<script type="module" id="Agregating paginated data with async/await">

    // import axios from "https://cdn.jsdelivr.net/npm/axios@1.7.2/+esm";
    
    // const getPostsFromPage = (_page) => axios.get("https://jsonplaceholder.typicode.com/posts", {
    //         params: {
    //             _page,
    //             _limit: 5,
    //         }
    //     })
    //     .then(res => res.data);


    // const getPostsFromFirstPages = async () => [
    //     ...await getPostsFromPage(1),
    //     ...await getPostsFromPage(2),
    //     ...await getPostsFromPage(3)
    // ];

    // const getPostsFromFirstPages = async () => (await Promise.all([
    //         getPostsFromPage(1),
    //         getPostsFromPage(2),
    //         getPostsFromPage(3),
    //     ])).flat();

    // getPostsFromFirstPages().then(console.log);



    /* Waterfall without Parallelization and with Parallelization. */
    // const getPostsPages = async () => [
    //     ...await getPostsFromPage(1),
    //     ...await getPostsFromPage(2),
    //     ...await getPostsFromPage(3),
    //     ...await getPostsFromPage(4),
    //     ...await getPostsFromPage(5),
    //     ...await getPostsFromPage(6),
    //     ...await getPostsFromPage(7),
    //     ...await getPostsFromPage(8),
    //     ...await getPostsFromPage(9),
    //     ...await getPostsFromPage(10),
    //     ...await getPostsFromPage(11),
    //     ...await getPostsFromPage(12),
    //     ...await getPostsFromPage(13),
    //     ...await getPostsFromPage(14),
    //     ...await getPostsFromPage(15),
    //     ...await getPostsFromPage(16),
    //     ...await getPostsFromPage(17),
    //     ...await getPostsFromPage(18),
    //     ...await getPostsFromPage(19),
    //     ...await getPostsFromPage(20),
    // ];

    // const getPostsPagesParallel = async (amountOfPages) => Promise.all(
    //     Array.from({length: amountOfPages}, (_, i) => getPostsFromPage(i + 1))
    // ).then(array => array.flat());

    // const getPostsPagesParallel = async (amountOfPages) => (await Promise.all(
    //     Array.from({length: amountOfPages}, (_, i) => getPostsFromPage(i + 1))
    // )).flat();


    // getPostsPages().then(console.log);
    // getPostsPagesParallel(20).then(console.log);

</script>

<script type="module" id="Star Wars API Pagination & Crawling/Scraping">

    // const swapiPage = (page = 1) => `https://swapi.dev/api/people/?${new URLSearchParams({ page }).toString()}`;
    // const endpoints = Array.from({ length: 9 }, (_, i) => swapiPage(i + 1));
    // console.log(endpoints);

    // const getAllStarWarsPeople = () => Promise.all(
    //         endpoints.map((url) => fetch(url)
    //             .then(res => res.json())
    //             .then(data => data.results)
    //         )
    //     ).then(pages => pages.flat());
    
    // const getAllStarWarsPeople = async () => (await Promise.all(
    //         endpoints.map((url) => fetch(url)
    //             .then(res => res.json())
    //             .then(data => data.results)
    //         )
    //     )).flat()

    // getAllStarWarsPeople().then(console.log);
        


    // const url = "https://swapi.dev/api/people";
    // const get = (url) => fetch(url).then(res => res.json());

    // const getAllStarWarsPeopleLoop = async () => {
    //     const people = [];

    //     let data = await get(url);
    //     people.push(...data.results);

    //     console.log(data);

    //     /* Load more people. */

    //     while (data.next) {
    //         data = await get(data.next);
    //         people.push(...data.results);
    //     }

    //     return people;
    // };

    // getAllStarWarsPeopleLoop().then(console.log);



    // const getAllStarWarsDataRecursion = async (url, results = []) => {
    //     console.log(`Getting data from ${url}`);

    //     const data = await get(url);
    //     results.push(...data.results);
    //     /* results = [...results, ...data.results]; */

    //     if (data.next === null) return results;
    //     return await getAllStarWarsDataRecursion(data.next, results);
    // };
    
    // getAllStarWarsDataRecursion(url).then(console.log);



    // const planetsUrl = "https://swapi.dev/api/planets";
    // getAllStarWarsDataRecursion(planetsUrl).then(console.log);



    // const renderList = (entities = []) => {
    //     const list = document.createElement("ol");
    //     const items = entities.map(entity => {
    //         const li = document.createElement("li");
    //         li.textContent = entity["name"];
            
    //         return li;
    //     });
    //     list.append(...items);
    //     document.body.appendChild(list);
    // };

    // const starWarsEndpoints = [
    //     "https://swapi.dev/api/people",
    //     "https://swapi.dev/api/planets",
    //     "https://swapi.dev/api/starships",
    //     "https://swapi.dev/api/vehicles",
    // ];

    // Promise.all(starWarsEndpoints.map(url => getAllStarWarsDataRecursion(url, [])))
    //     .then(results => results.map(renderList));

    

    // /* Node.js Web Scraping - CORS in Browser environment. */
    // fetch("https://demotywatory.pl/").then(res => res.text()).then(console.log);

</script>